## 一、知识总览

![img](https://img2018.cnblogs.com/blog/1358881/201909/1358881-20190914210628844-381768709.png)

 信号量机制的基本原理：两个或多个进程可以利用彼此间收发的简单的信号来实现“正确的”并发执行，一个进程在收到一个指定信号前，会被迫在一个确定的或者需要的地方停下来，从而保持同步或互斥。



![img](https://img2018.cnblogs.com/blog/1358881/201909/1358881-20190914210757492-1055272907.png)

## 二、整型信号量

![img](https://img2018.cnblogs.com/blog/1358881/201909/1358881-20190914210935890-34681599.png)

## 三、记录型信号量

![img](https://img2018.cnblogs.com/blog/1358881/201909/1358881-20190914211253109-682161049.png)

 

[![复制代码](https://common.cnblogs.com/images/copycode.gif)](javascript:void(0);)

```
typedef struct{
    int value;
    struct process *L;
}semaphore//信号量

void wait(semaphore S){//wait原语
    S.value--;
    if(S.value<0){
        block(S.L);//阻塞原语
    }
}

void signal(semaphore S){//signal原语
    S.value++;
    if(S.value<=0){
        wakeup(S.L);//唤醒原语
    }
}
```

[![复制代码](https://common.cnblogs.com/images/copycode.gif)](javascript:void(0);)

 ![img](https://img2018.cnblogs.com/blog/1358881/201909/1358881-20190914211407152-1832173900.png)

## 四、信号量机制总结：

![img](https://img2018.cnblogs.com/blog/1358881/201909/1358881-20190914211437602-848203176.png)

 ![img](https://img2018.cnblogs.com/blog/1358881/201909/1358881-20190915134100259-1326628875.png)

## 五、信号量机制实现进程互斥

互斥信号量的初值实际上是表示某种资源的数量，而我们这里临界区同一时间段内只允许一个进程来访问，所以可以把临界区理解成一种特殊的资源，该资源只有一个，只能被分配给一个进程使用，只有这个进程释放了，才能被其他进程使用。如果一个进程需要使用临界区这种特殊的资源的时候，那么使用之前就应该对其所对应的信号量进行P操作，使用之后进行V操作。

![img](https://img2018.cnblogs.com/blog/1358881/201909/1358881-20190915134444044-483082967.png)

对不同的临界资源需要设置不同的互斥信号量。

## 六、信号量机制实现进程同步

![img](https://img2018.cnblogs.com/blog/1358881/201909/1358881-20190915135434741-2076903343.png)

![img](https://img2018.cnblogs.com/blog/1358881/201909/1358881-20190915135612260-1362223675.png)

**设置同步信号量S，初始化为0**

**在“前操作”之后执行V(S)**

**在“后操作”之前执行P(S)**

## 七、信号量机制实现前驱关系

前驱关系：只有S1执行了之后才能执行S2，只有S2执行了之后才能执行S4和S5......

![img](https://img2018.cnblogs.com/blog/1358881/201909/1358881-20190915140319276-1184668052.png)

##  八、总结

![img](https://img2018.cnblogs.com/blog/1358881/201909/1358881-20190915141425116-1612789989.png)