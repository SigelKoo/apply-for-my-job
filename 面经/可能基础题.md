go GC

情况：白色被挂在黑色，灰色丢了白色。解决：强三色和弱三色，插入屏障，用于堆，B被挂在A的下游，必须被标记为灰色。栈在准备回收白色时，再扫描一次，同时使用STW。删除屏障，对象被删除时，如果为灰色或白色，被标记为灰色，下一轮被清理。栈上对象全部扫描并标记为黑色，栈上创建的新对象为黑色



goroutine特点

内核空间，用户空间M:N，占用内存为几KB，可伸缩分配内存



GMP

全局队列，P本地队列，P列表，M内核线程；根据GOMAXPROCS()创建P；没有足够的M关联P运行G，寻找空闲M，没有空闲创建；复用线程、利用并行、抢占时间片

本地队列满了，将创建的前一半打乱顺序放入全局队列；可以唤醒休眠线程（自旋），从全局队列区一个放入本线程、偷取其他线程的G；系统调用，解绑M和P，其他的G被休眠线程绑定；退出系统调用，尝试获取P2，如果无法获取G会加入全局队列，M休眠。

 

HTTP 1.0/1.1

长连接、错误码、缓存处理、Host头处理、带宽优化



HTTP 1.1/2.0

header压缩、新的二进制格式、服务器推送、多路复用



TCP保证稳定

校验（源IP、目的IP、长度、协议号等，二进制反码求和，全为1？）、序号、确认、重传



session与cookie区别

session依赖cookie、cookie有大小限制，站点也有个数限制，存在安全隐患、session服务器资源消耗



拥塞避免

慢开始、拥塞避免（降到慢开始门限）、快重传、快恢复（慢开始门限的一半）

拥塞窗口和接收窗口最小值



粘包和拆包

消息定长、消息头中包含消息长度、按消息边界分离



大量CLOSE_WAIT

socket未close()、相应太慢、timeout太小



避免DDos

更好的硬件和带宽、避免NAT、静态网页



负载均衡

轮询、随机、哈希、最小连接



GET与POST区别

GET幂等，POST修改资源；GET请求；数据量大小；安全性；ASCII；一个两个数据包



HTTP请求包括

请求行（方法GET、URL和HTTP版本）、请求头部（浏览器类型、主机名等）、请求数据



无状态

无状态：每次请求没有联系都是独立的，1.1中时间很短，时间一过，还需要重新握手

 

进程通信

共享存储、消息传递、管道通信、客户端服务器、信号、信号量



Linux进程调度

Linux-CFS-nice、实时优先级，IO消耗型和CPU消耗型



内存分配与管理

brk、mmap、连续分配（重定位寄存器，物理地址+逻辑地址）、页式（页表寄存器，页号找页框号，页框号+页内偏移量）、段式（段表寄存器，段号找基址，基址+段内地址）、段页式（段表寄存器，段号找页号，页号找页框号，页框号+页内偏移量）



IO模型

BIO：水龙头有水且杯子接满才离开；NIO：经常回来看看有水吗；select：一排水龙头，阿姨告诉有水，一个个试；epoll：阿姨告诉是哪个水龙头有水；AIO：阿姨接好水联系



innodb与myisam区别

事务；事务隔离级别（默认可重复读）；行锁级；外键；MVCC；并行下效果更好



解决幻读

MVCC快照读；next-key，>100 for update 将100到无限大都锁住



主从复制

binlog->中继日志->更新slave



数据库范式

列不可再分；消除部份依赖；消除传递依赖



ON与WHERE区别

ON是在临时表生成时使用的条件；WHERE是在临时表生成后使用的条件



防止死锁

按相同顺序操作多张表；对数据排序批量操作单张表；申请排他锁；使用WHERE，大事务切为小事务；使用等值而不是范围



数据库三种日志区别

redo记录事务对数据做了哪些修改，用于崩溃恢复；binlog用于主从复制；undo记录反向sql语句，用于回滚事务



使用索引情况

经常distinct、orderby、groupby、where、连接，主键、外键；不要text索引数目、日期



数据库优化

explain SQL；SQL procedure analyse()数据类型优化；垂直水平切分；硬件优化；应用层



缓存与数据库不一致

读访问缓存，写访问缓存与数据库；使用队列



主键索引与唯一索引

主键不一定只有一个字段，主键不可为空，每个表只能有一个主键索引



增加索引语句

Alter table test add index idx(name)