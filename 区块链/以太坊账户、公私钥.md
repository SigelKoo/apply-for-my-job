# 以太坊账户

以太坊中账户有两种类型：

1. 外部账户
2. 合约账户

外部账户中维护的状态是账户的余额，合约账户中维护的是余额和合约中的内容，这些状态会通过以太坊网络进行更新以及保证数据的一致性。

账户标识了以太坊网络中每一个参与者的身份，每一笔交易都需要通过账户使用公钥加密进行签名才能够正常进行，这样的话，EVM（以太坊虚拟机）才能够对交易发送者进行验证来确保交易的真实可靠。

# 以太坊地址

一个以太坊地址就代表着一个以太坊账户，地址是账户的标识。对于外部账户来说，地址表示的是该账户公钥的后20字节（通常会以0x开头，例如，`0xcd2a3d9f938e13cd947ec05abc7fe734df8dd826`，该地址使用的是16进制表示法）

# 公钥与私钥

以太坊的私钥是一串64位16进制字符（32字节）。它是账户安全最重要的部分，需要妥善保管，如果丢失了私钥也就意味着你的账户丢失了。

在keystore文件中的私钥加密信息有：

- address：该账户的地址
- cipher：加密方法使用的是AES-128-CTR算法
- ciphertext：加密后的密文
- cipherparams：AES-128-CTR算法加密所需的相关参数
- kdf：秘钥生成函数，用于使用密码对keystore文件进行加密
- kdfparams：kdf算法所需的参数
- mac：用于验证密码的编码

## 生成流程

![img](https://pic3.zhimg.com/80/v2-f8ecabfbfc415e64489ba0fad89fe4ae_720w.jpeg)

### 生成私钥

生成一个随机的私钥（32字节）

### 私钥推导公钥

私钥是一组65位的16进制字符，通过私钥我们能够访问一个账户。以太坊的私钥生成是通过secp256k1椭圆曲线算法生成的，secp256k1是一个椭圆曲线算法，同比特币。

### 公钥推导地址

和比特币相比，在私钥生成公钥这一步其实是一样的，区别在公钥推导地址第一部分，以太坊中非圧缩型公钥的处理就简单粗暴很多了，下图为Public Key生成Address的过程。

```
第一步：私钥 (private key)
　　伪随机数产生的256bit私钥示例(256bit  16进制32字节)
　　18e14a7b6a307f426a94f8114701e7c8e774e7f9a47e2c2035db29a206321725

第二步：公钥 (public key)
　　1. 采用椭圆曲线数字签名算法ECDSA-secp256k1将私钥（32字节）映射成公钥（65字节）（前缀04+X公钥+Y公钥）：
　　04
　　50863ad64a87ae8a2fe83c1af1a8403cb53f53e486d8511dad8a04887e5b2352
　　2cd470243453a299fa9e77237716103abc11a1df38855ed6f2ee187e9c582ba6

 2. 拿公钥（非压缩公钥）来hash，计算公钥的 Keccak-256 哈希值（32bytes）：
　　fc12ad814631ba689f7abe671016f75c54c607f082ae6b0881fac0abeda21781
 
 3. 取上一步结果取后20bytes即以太坊地址：
　　1016f75c54c607f082ae6b0881fac0abeda21781

第三步：地址 (address)
　　0x1016f75c54c607f082ae6b0881fac0abeda21781
```

