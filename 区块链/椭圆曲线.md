椭圆曲线密码ECC是利用椭圆曲线来实现的密码技术统称。

主要包括

- 椭圆曲线公钥密码
- 椭圆曲线数字签名
- 椭圆曲线密钥交换

SSL/TLS中使用了椭圆曲线迪菲赫尔曼密钥交换（ECDH、ECDHE）和椭圆曲线公钥密码（ECDSA）；比特币中使用了ECDSA

比特币和以太坊中椭圆曲线为SECP256K1
$$
y^2=x^3+7
$$
椭圆曲线加法是椭圆曲线上两点A、B，过两点画一条直线，找到直线与椭圆曲线交点，交点关于x轴对称位置的点定义为A+B

椭圆曲线乘法是椭圆曲线上多次加法运算，椭圆曲线上的二倍运算是点A做椭圆曲线的切线（求偏导），找到该切线与椭圆曲线的交点，交点关于x轴对称位置的点定义为A+A（2A）

给定椭圆曲线某一点G，可以求出2G、3G...给定点G，已知数x求xG并不难，而反过来，已知点xG求数x非常困难，即椭圆曲线上的离散对数问题。

有限域上的椭圆曲线运算即
$$
y^2 \equiv x^3 + 7(mod 23)
$$
y的平方除以23的余数 等于 x的三次方加7除以23的余数，这里素数推荐使用梅森素数

##### 椭圆曲线上的密钥交换（迪菲赫尔曼密钥交换）

1. Alice向Bob发送点G，点G可被Eve窃听
2. Alice生成随机数a作为自己的私钥，并将a·G发送给Bob，a·G可被Eve窃听，为Alice公钥
3. Bob生成随机数b作为自己的私钥，并将b·G发送给Alice，b·G可被Eve窃听，为Bob公钥
4. Alice对b·G计算在椭圆曲线上a倍的点，即得到abG，Bob对a·G计算在椭圆曲线上b倍的点，即得到abG
5. Alice和Bob得到了共享密钥，可以进行通信

SSL/TLS中可以每次更改随机数a、b保证共享密钥的安全性

##### 椭圆曲线ElGamal

基于迪菲赫尔曼密钥交换

1. Alice要向Bob发送一条消息，Alice可以将自己要发送的消息用椭圆曲线上点M的x坐标表示
2. Alice用自己的私钥a和Bob的公钥b·G，对消息计算出M+abG，即密文
3. Alice将密文M+abG发送给Bob
4. Bob用Alice的公钥aG与自己的私钥b计算出abG，M+abG减去abG，即可得到消息M

##### ECSDA

###### 生成

1. Alice根据随机数r和点G计算r·G
2. Alice根据随机数r、消息m和消息的散列值h、私钥a计算s=(h+ax)/r
3. Alice将消息m、r·G和s发送给Bob，r·G和s作为数字签名

###### 验证

1. Bob接收到消息m，r·G和s

2. Bob根据消息m求出散列值h

3. 通过Alice公钥
   $$
   \frac{h}{s}G + \frac{x}{s}aG=\frac{h+ax}{s}G=\frac{r(h+ax)}{h+ax}G=rG
   $$
   



