# 进程间通信方式、线程间通信方式

进程：无名管道、命名管道、信号、信号量、共享内存、消息队列、套接字

- 无名管道（PIPE）：传递数据是单向性的，只能从一方流向另一方，也就是一种半双工的通信方式，只用于有亲缘关系的进程间的通信，亲缘关系是父子进程或兄弟进程

- 命名管道（FIFO）：非亲缘关系也可通信。进程调用mkfifo创建有名管道

	区别：

	* 创建并打开一个无名管道只需调用pipe；创建并打开一个命名管道则需在调用mkfifo后再调用
	* 无名管道在所有进程都关闭它后自动消失；命名管道只有通过调用unlink，文件系统才会删除
* 信号：信号是软件中断产生，用于进程间异步传递信息
* 信号量：整数计数器，被用来控制对公共资源（共享内存）的访问。它常作为一种锁机制，防止某进程正在访问共享资源时，其他进程也访问该资源。因此，主要作为进程间以及同一进程内不同线程之间的同步手段。编程时可根据操作信号量值的结果判断是否对公共资源具有访问的权限，当信号量值大于 0 时，则可以访问，否则将阻塞。PV 原语是对信号量的操作，一次 P 操作使信号量减１，一次 V 操作使信号量加１。不同进程对共享数据进行访问时使用，因为两个进程不能同时对同一数据进行访问

- 共享内存：共享内存允许多个进程共享一个给定的存储区域，由于是共享一块内存数据，因此其速度很快
- 消息队列：存储在内核中的消息链表，进程可以在没有另一个进程等待读的情况下进行写。另外一方面，无名管道和命名管道一旦相关进程都关闭并退出后，里面的数据也就没有了，但是对于消息队列，一个进程往消息队列中写入数据后退出，另外一个仍然可以打开并读取数据
- 套接字：在内核中，socket是一个文件，socket对应的inode不像真正的文件系统一样，保存在硬盘上，而是保存在内存中，不同主机间的进程双向通信的端点

线程：同一进程的地址空间、互斥（同步）量、自旋锁、读写锁、线程信号（Message消息机制）、条件变量

互斥量：一条线程加锁锁住临界区，另一条线程尝试访问该临界区的时候，会发生阻塞，并进入休眠状态

自旋锁：一条线程加锁锁住临界区，另一条线程尝试访问该临界区的时候，会发生阻塞，但是不会进入休眠状态，并且不断轮询该锁，直至原来锁住临界区的线程解锁

​		区别

​		自旋锁与互斥锁功能一样，唯一一点不同就是互斥量阻塞后休眠让出CPU，而自旋锁阻塞后不会让出CPU，会一直忙等待，直到得到锁。自旋锁在用户态使用的比较少，在内核态使用的比较多。自旋锁使用的场景有：锁的持有时间比较短，或者说小于两次上下文切换的时间

- 读写锁：1. 读状态加锁-共享锁，当一个线程加了读锁时，其他线程如果也尝试以读模式进入临界区，那么不会发生阻塞，直接访问临界区；2.写状态加锁-独占锁，当一个线程加了写锁时，那么其他线程尝试访问该临界区（不论读写），都会阻塞等待
- 条件变量：条件变量用来自动阻塞一个线程，使某进程休眠，并等待某种条件出现。通常条件变量和互斥锁同时使用

